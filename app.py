import os
from flask import Flask,request,send_file
import openpyxl as xl
from openpyxl.utils import get_column_letter
from openpyxl.styles import PatternFill
from PIL import Image
import base64
import io
from pathlib import Path

app = Flask(__name__)

@app.route("/",methods=["GET","POST"])
def main(data=None):
    if request.method == "GET":
        return """
        Send a post request to this endpoint containing a base64 image.
        You will get a xlsx file as a response.<br>
        <bold>If the file is too big, you sill get an error</bold>
        Example:
        <br>
        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==
        """
    if request.method == "POST":
        output = Path('output.xlsx')
        if output.is_file():
            os.remove('output.xlsx')
        data = request.data
        imgbytes = base64.b64decode(data)
        buf = io.BytesIO(imgbytes)
        img = Image.open(buf)
        pix = img.load()
        width,height = img.size
        wb = xl.Workbook()
        ws = wb.active
        for row in range(height):
            for col in range(width):
                columLetter = get_column_letter(col +1)
                ws.row_dimensions[row +1].heigth = 2.5
                ws.column_dimensions[columLetter].width = 1
                rgb = pix[col,row]
                hexColor = '{:02x}{:02x}{:02x}'.format(rgb[0],rgb[1],rgb[2])
                cell = ws.cell(row=row +1,column=col +1,value='')
                cell.fill = PatternFill(start_color=hexColor,end_color=hexColor,fill_type='solid')
        ws.sheet_view.zoomScale = 20
        wb.save(output.absolute())
        return send_file('output.xlsx',as_attachment=True)

if __name__ == "__main__":
    port = int(os.environ.get("PORT", 5000))
    app.run(host='0.0.0.0', port=port)